# 推理链节点选择规则表 (Node Selection Logic Table)

## 概述

本表格基于 79 道 Browsecomp 题目的自然语言约束模式分析，将题目中的线索类别映射到知识图谱的**下一跳节点**和**对应的边**。

## Schema 标准 (严格遵守)

### 5 类核心节点
| Node Type | 中文名称 | 描述 |
|-----------|---------|------|
| **Paper** | 论文本体 | 研究论文、学位论文、文章 |
| **Author** | 作者 | 论文的作者、撰稿人 |
| **Institution** | 机构 | 大学、研究机构、公司、组织 |
| **Venue** | 发表载体 | 期刊、会议、研讨会 |
| **Entity** | 论文相关实体 | 从论文中提取的实体（方法、数据集、药物、奖项等）|

### 5 类核心边
| Edge Type | 中文描述 | 方向 |
|-----------|---------|------|
| **HAS_AUTHOR** | 写作/著作关系 | Paper → Author |
| **AFFILIATED_WITH** | 隶属/任职关系 | Author → Institution |
| **PUBLISHED_IN** | 发表关系 | Paper → Venue |
| **MENTIONS** | 包含/提及关系 | Paper → Entity |
| **CITES** | 引用关系 | Paper → Paper |

---

## 节点选择逻辑表

| 题目中的线索类别 (Constraint Category) | 典型关键词 (Trigger Keywords) | 目标节点 (Next Hop Node) | 对应的边/动作 (Edge to Follow) |
|:---|:---|:---|:---|
| **1. 时间/发表年份** | "published between X and Y", "before 2010", "after 2000", "in the 1970s", "submitted in [month/year]", "published online in [year]" | **Paper** | 检查 `Paper.publication_year` 属性 (无跳转，直接过滤) |
| **2. 作者数量** | "co-authored by N authors", "written by N people", "six authors", "three co-authors" | **Author** | `HAS_AUTHOR` (Paper → Author)，计算作者数量 |
| **3. 机构隶属/任职** | "affiliated with", "worked at", "faculty member at", "employed by", "from [university/institution]" | **Institution** | `AFFILIATED_WITH` (Author → Institution) |
| **4. 学位获取** | "Ph.D. from", "received degree from", "earned B.A./M.Sc. from", "obtained degree at", "undergraduate degree at" | **Institution** | `AFFILIATED_WITH` (Author → Institution)，检查 `Institution.degree_granted` 属性 |
| **5. 发表载体/期刊/会议** | "published in", "journal", "conference", "proceedings", "symposium paper", "open-access journal", "official journal of" | **Venue** | `PUBLISHED_IN` (Paper → Venue) |
| **6. 机构成立时间** | "university founded between X and Y", "established in", "chartered after/before", "oldest university", "fourth oldest" | **Institution** | 检查 `Institution.founded_year` 属性 (无跳转，当前节点过滤) |
| **7. 奖项/荣誉** | "awarded", "elected fellow", "received prize", "named [fellow/scholar]", "honorary degree", "recognized for" | **Entity** | `MENTIONS` (Paper → Entity)，其中 `Entity.type = "award"` 或检查 Author 属性 |
| **8. 引用关系** | "cited", "reference", "bibliography", "cites", "reference list", "references cited", "reference number N" | **Paper** | `CITES` (Paper → Paper) 或反向 `CITED_BY` |
| **9. 合作关系** | "co-authored with", "collaborated", "same authors as", "shared authors", "together with" | **Author** | `HAS_AUTHOR` (Paper → Author)，找同一 Paper 的其他 Author |
| **10. 研究主题/领域** | "paper discusses", "explores", "focuses on", "study of", "research on", "analyzes" | **Entity** | `MENTIONS` (Paper → Entity)，其中 `Entity.type = "research_topic"` |
| **11. 方法学/技术** | "method", "technique", "approach", "model", "algorithm", "regression", "neural network", "spectroscopy" | **Entity** | `MENTIONS` (Paper → Entity)，其中 `Entity.type = "method"` |
| **12. 数据/样本详情** | "sample size", "N participants", "specimens", "subjects", "data", "database", "dataset" | **Entity** | `MENTIONS` (Paper → Entity)，其中 `Entity.type = "data"` 或 `Entity.type = "dataset"` |
| **13. 论文结构属性** | "title contains", "title ends with", "N tables", "N figures", "N references", "abstract", "acknowledgments section", "author contributions" | **Paper** | 检查 `Paper` 属性 (title, tables_count, figures_count, references_count, sections) |
| **14. 致谢内容** | "acknowledgments section", "thanked", "acknowledged for", "dedicated to", "expressed gratitude" | **Entity** | `MENTIONS` (Paper → Entity)，其中 `Entity.type = "acknowledged_person"` 或从 acknowledgments 文本提取 |
| **15. 资助信息** | "funded by", "grant", "scholarship", "support from", "funding source" | **Entity** | `MENTIONS` (Paper → Entity)，其中 `Entity.type = "funding"` |
| **16. 会议/演讲** | "speaker at", "talk at", "presentation", "symposium", "conference presentation", "invited speaker" | **Entity** | `MENTIONS` (Paper → Entity)，其中 `Entity.type = "event"` 或 `Author.event_participation` 属性 |
| **17. 专业职位/头衔** | "Professor", "Associate Professor", "faculty", "researcher", "principal investigator", "chair", "director", "head" | **Author** | 检查 `Author.position` 属性 (无跳转，当前节点过滤) |
| **18. 生日/出生地** | "born between X and Y", "born in [city/year]", "age" | **Author** | 检查 `Author.birth_year`, `Author.birth_place` 属性 |
| **19. 论文标题格式** | "title ends with", "title is phrased as a question", "title includes word", "full title" | **Paper** | 检查 `Paper.title` 属性 (无跳转，当前节点过滤) |
| **20. 具体实体(药物/材料等)** | "drug", "medicine", "compound", "protein", "gene", "molecule", "element", "material", "plant" | **Entity** | `MENTIONS` (Paper → Entity)，其中 `Entity.type = "chemical_entity"` 或具体类型 |
| **21. 地理位置线索** | "located in", "city of", "country", "state", "region" | **Institution** | 检查 `Institution.location` 属性 |
| **22. 作者顺序** | "first author", "second author", "third author", "last author", "corresponding author", "in that very order" | **Author** | `HAS_AUTHOR` (Paper → Author)，检查 `Author.author_order` 属性 |
| **23. 共同发表历史** | "previously co-authored in", "another paper by", "also published", "same year published" | **Paper** | `HAS_AUTHOR` (Paper → Author) → `HAS_AUTHOR` (Author → Paper) 反向查找 |
| **24. 审稿/编辑** | "edited by", "reviewer", "editor of journal", "author notes" | **Author** 或 **Entity** | 检查 `Author.editorial_role` 属性或 `MENTIONS` 提取编辑信息 |
| **25. 特定数值/测量值** | "temperature between X and Y", "modulus", "density", "N citations", "N pages", "percent" | **Entity** | `MENTIONS` (Paper → Entity)，其中 `Entity.type = "measurement"` 或 `Entity.value` 属性 |
| **26. 公司/商业实体** | "company", "corporation", "foundation", "non-profit", "industry" | **Institution** | `AFFILIATED_WITH` (Author → Institution) 其中 `Institution.type = "company"` |
| **27. 出版细节** | "volume N", "issue N", "page numbers", "DOI", "accepted in", "received in", "revised" | **Paper** 或 **Venue** | 检查 `Paper.publication_details` 或 `Venue` 属性 |
| **28. 人名/人物匹配** | "name identical to", "same name as", "full name", "first/last name" | **Author** | 检查 `Author.name` 属性 |
| **29. 导师关系** | "supervised by", "advisor", "major professor", "PhD supervisor", "mentor" | **Author** | `MENTIONS` (Paper → Entity) 或检查 `Author.advisor` 关系 |
| **30. 院系/学科** | "department of", "faculty of", "school of", "institute of" | **Institution** | `AFFILIATED_WITH` (Author → Institution)，检查 `Institution.department` 或 `Institution.faculty` |

---

## 补充说明

### Schema 映射规则

1. **Education → Institution**: 学位信息映射为 `Author` 与 `Institution` 的 `AFFILIATED_WITH` 关系，并在边或节点上附加 `degree_type` 属性
2. **Event → Entity**: 会议、演讲等活动映射为 `Paper` 通过 `MENTIONS` 关系连接的 `Entity`，`Entity.type = "event"`
3. **Position → Author attribute**: 职位信息作为 `Author` 节点的属性存储
4. **Award → Entity**: 奖项映射为 `Paper` 提及的 `Entity`，`Entity.type = "award"`，或作为 `Author.award` 属性

### 常见推理链模式

```
# 模式 A: Paper → Author → Institution (论文-作者-机构链)
约束: "published between 2015-2020" + "author affiliated with oldest university"
动作: Paper (过滤年份) → HAS_AUTHOR → Author → AFFILIATED_WITH → Institution (过滤 founded_year)

# 模式 B: Author → Institution (学位/任职信息)
约束: "Ph.D. in 1983" + "elected fellow between 2005-2020"
动作: Author (过滤 Ph.D. year) → AFFILIATED_WITH → Institution
     同时检查 Author.awards 属性

# 模式 C: Paper → Entity (内容/实体提取)
约束: "paper discusses drug X" + "mentions method Y"
动作: Paper → MENTIONS → Entity (type=drug) → MENTIONS → Entity (type=method)

# 模式 D: Paper ← CITES ← Paper (引用链)
约束: "cites reference published between 1990-2015"
动作: Paper → CITES → Paper (过滤 publication_year)

# 模式 E: Paper → Author → Paper (合作链)
约束: "two authors previously co-authored in 1994"
动作: Paper → HAS_AUTHOR → Author → (反向) HAS_AUTHOR → Paper (过滤 1994)
```

---

## 验证测试

开发人员可使用以下测试用例验证节点选择逻辑：

| 测试用例 | 约束描述 | 预期路径 |
|:---|:---|:---|
| TC1 | "published before 2010 by five authors, three from same university" | Paper(year<2010) → HAS_AUTHOR → Author (5个) → AFFILIATED_WITH → Institution (找3个相同) |
| TC2 | "author with Ph.D. in 1983, elected fellow 2005-2020" | Author (Ph.D. year=1983) → 检查 Author.awards (fellow year 2005-2020) |
| TC3 | "paper with 27 references, acknowledgments mention clinic founded 1990" | Paper (references=27) → MENTIONS → Entity (clinic, founded=1990) |
| TC4 | "co-authors previously published together in 1994" | Paper1 → HAS_AUTHOR → Author → (反向) HAS_AUTHOR → Paper2 (year=1994) |
| TC5 | "paper discusses international relations, published in oldest university journal" | Paper → MENTIONS → Entity (topic=international relations) → PUBLISHED_IN → Venue (oldest) |

---

## 与推理链模板的对应关系

| 节点选择规则类别 | 对应推理链模板 |
|:---|:---|
| 1. 时间/发表年份 | 模板 A, B, C, D, E, F, G |
| 2. 作者数量 | 模板 A, D |
| 3. 机构隶属/任职 | 模板 A, B, E |
| 4. 学位获取 | 模板 B |
| 5. 发表载体/期刊/会议 | 模板 C, E |
| 6. 机构成立时间 | 模板 A, B, E |
| 7. 奖项/荣誉 | 模板 B |
| 8. 引用关系 | 模板 C |
| 9. 合作关系 | 模板 D |
| 10. 研究主题/领域 | 模板 F |
| 11. 方法学/技术 | 模板 F |
| 12. 数据/样本详情 | 模板 F |
| 13. 论文结构属性 | 模板 A, C |
| 14. 致谢内容 | 模板 G |
| 15. 资助信息 | 模板 G |
| 16. 会议/演讲 | 模板 E |
| 17. 专业职位/头衔 | 模板 B |
| 18. 生日/出生地 | 模板 B |
| 19. 论文标题格式 | 模板 A |
| 20. 具体实体(药物/材料等) | 模板 F |
| 21. 地理位置线索 | 模板 A, B, E |
| 22. 作者顺序 | 模板 A, D |
| 23. 共同发表历史 | 模板 D |
| 24. 审稿/编辑 | 模板 B |
| 25. 特定数值/测量值 | 模板 F |
| 26. 公司/商业实体 | 模板 A, B |
| 27. 出版细节 | 模板 A, C |
| 28. 人名/人物匹配 | 模板 A, B, D, G |
| 29. 导师关系 | 模板 B, G |
| 30. 院系/学科 | 模板 A, B |
